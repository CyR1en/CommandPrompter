{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Static reference for CommandPrompter prompts.json",
  "type": "object",
  "additionalProperties": false,
  "required": ["prompts", "post_commands", "input_validators"],
  "properties": {
    "prompts": {
      "type": "array",
      "description": "A list of prompts. Each item is exactly one of: chat_prompt, anvil_prompt, or player_ui_prompt.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "oneOf": [
          { "$ref": "#/$defs/chatPromptWrapper" },
          { "$ref": "#/$defs/anvilPromptWrapper" },
          { "$ref": "#/$defs/playerUiPromptWrapper" }
        ]
      }
    },
    "post_commands": {
      "type": "array",
      "description": "Commands executed after prompt flow events.",
      "items": { "$ref": "#/$defs/postCommand" }
    },
    "input_validators": {
      "type": "array",
      "description": "Validators available to prompts by id.",
      "items": { "$ref": "#/$defs/inputValidator" }
    }
  },
  "$defs": {
    "cancelBehavior": {
      "type": "object",
      "additionalProperties": false,
      "required": ["send", "message", "clickable", "hover_message"],
      "properties": {
        "send": { "type": "boolean" },
        "message": { "type": "string", "minLength": 1 },
        "clickable": { "type": "boolean" },
        "hover_message": { "type": "string", "minLength": 1 }
      }
    },

    "anvilButton": {
      "type": "object",
      "additionalProperties": false,
      "required": ["show", "button_text", "button_icon", "button_hover_text", "custom_model_data"],
      "properties": {
        "show": { "type": "boolean" },
        "button_text": { "type": "string", "minLength": 1 },
        "button_icon": { "type": "string", "minLength": 1 },
        "button_hover_text": { "type": "string", "minLength": 1 },
        "custom_model_data": { "type": "integer", "minimum": 0 }
      }
    },

    "uiButton": {
      "type": "object",
      "additionalProperties": false,
      "required": ["show", "location", "button_text", "button_icon", "button_hover_text", "custom_model_data"],
      "properties": {
        "show": { "type": "boolean" },
        "location": { "type": "integer", "minimum": 1 , "maximum": 9},
        "button_text": { "type": "string", "minLength": 1 },
        "button_icon": { "type": "string", "minLength": 1 },
        "button_hover_text": { "type": "string", "minLength": 1 },
        "custom_model_data": { "type": "integer", "minimum": 0 }
      }
    },

    "chatPrompt": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "prompt_text", "cancel"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "prompt_text": { "type": "string", "minLength": 1 },
        "cancel": { "$ref": "#/$defs/cancelBehavior" },
        "input_validator": { "type": "string", "minLength": 1 }
      }
    },

    "anvilPrompt": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "title", "prompt_text", "left_button", "right_button"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "title": { "type": "string", "minLength": 1 },
        "prompt_text": { "type": "string", "minLength": 1 },
        "left_button": { "$ref": "#/$defs/anvilButton" },
        "right_button": { "$ref": "#/$defs/anvilButton" },
        "input_validator": { "type": "string", "minLength": 1 }
      }
    },

    "playerUiPrompt": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "prompt_text"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "prompt_text": { "type": "string", "minLength": 1 },
        "filter": { "type": "string" },
        "cancel_button": { "$ref": "#/$defs/uiButton" },
        "previous_button": { "$ref": "#/$defs/uiButton" },
        "next_button": { "$ref": "#/$defs/uiButton" },
        "input_validator": { "type": "string", "minLength": 1 }
      }
    },

    "chatPromptWrapper": {
      "type": "object",
      "additionalProperties": false,
      "required": ["chat_prompt"],
      "properties": {
        "chat_prompt": { "$ref": "#/$defs/chatPrompt" }
      }
    },

    "anvilPromptWrapper": {
      "type": "object",
      "additionalProperties": false,
      "required": ["anvil_prompt"],
      "properties": {
        "anvil_prompt": { "$ref": "#/$defs/anvilPrompt" }
      }
    },

    "playerUiPromptWrapper": {
      "type": "object",
      "additionalProperties": false,
      "required": ["player_ui_prompt"],
      "properties": {
        "player_ui_prompt": { "$ref": "#/$defs/playerUiPrompt" }
      }
    },

    "postCommand": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "command", "execution_policy", "execute_as", "delay"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "command": { "type": "string", "minLength": 1 },
        "execution_policy": { "type": "string", "enum": ["on_complete", "on_cancel"] },
        "execute_as": { "type": "string", "enum": ["console", "player"] },
        "delay": { "type": "integer", "minimum": 0 }
      }
    },

    "regexValidator": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "regex"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "regex": { "type": "string", "minLength": 1 }
      }
    },

    "onlinePlayerValidator": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "check_online_player"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "check_online_player": { "type": "boolean" }
      }
    },

    "inputValidator": {
      "oneOf": [
        { "$ref": "#/$defs/regexValidator" },
        { "$ref": "#/$defs/onlinePlayerValidator" }
      ]
    }
  }
}